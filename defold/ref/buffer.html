<html><head><link rel='stylesheet' type='text/css' href='../defold.css'></head><body><div class='nav'><a class='chevron' href='../index.html'><img src='../svg/chevron-left.svg' alt='Home'></a></div><h1>Buffer</h1>
<p><p>Functions for manipulating buffers and streams</p></p>
<h1><a name='//apple_ref/cpp/Variable/buffer.VALUE_TYPE_FLOAT32' class='dashAnchor'></a><a class='entry' name='buffer.VALUE_TYPE_FLOAT32'>buffer.VALUE_TYPE_FLOAT32</a></h1><div class='brief'><p>float32</p></div><p><p>Float, single precision, 4 bytes</p></p><hr/><h1><a name='//apple_ref/cpp/Variable/buffer.VALUE_TYPE_FLOAT64' class='dashAnchor'></a><a class='entry' name='buffer.VALUE_TYPE_FLOAT64'>buffer.VALUE_TYPE_FLOAT64</a></h1><div class='brief'><p>float64</p></div><p><p>Float, double precision, 8 bytes</p></p><hr/><h1><a name='//apple_ref/cpp/Variable/buffer.VALUE_TYPE_INT16' class='dashAnchor'></a><a class='entry' name='buffer.VALUE_TYPE_INT16'>buffer.VALUE_TYPE_INT16</a></h1><div class='brief'><p>int16</p></div><p><p>Signed integer, 2 bytes</p></p><hr/><h1><a name='//apple_ref/cpp/Variable/buffer.VALUE_TYPE_INT32' class='dashAnchor'></a><a class='entry' name='buffer.VALUE_TYPE_INT32'>buffer.VALUE_TYPE_INT32</a></h1><div class='brief'><p>int32</p></div><p><p>Signed integer, 4 bytes</p></p><hr/><h1><a name='//apple_ref/cpp/Variable/buffer.VALUE_TYPE_INT64' class='dashAnchor'></a><a class='entry' name='buffer.VALUE_TYPE_INT64'>buffer.VALUE_TYPE_INT64</a></h1><div class='brief'><p>int64</p></div><p><p>Signed integer, 8 bytes</p></p><hr/><h1><a name='//apple_ref/cpp/Variable/buffer.VALUE_TYPE_INT8' class='dashAnchor'></a><a class='entry' name='buffer.VALUE_TYPE_INT8'>buffer.VALUE_TYPE_INT8</a></h1><div class='brief'><p>int8</p></div><p><p>Signed integer, 1 byte</p></p><hr/><h1><a name='//apple_ref/cpp/Variable/buffer.VALUE_TYPE_UINT16' class='dashAnchor'></a><a class='entry' name='buffer.VALUE_TYPE_UINT16'>buffer.VALUE_TYPE_UINT16</a></h1><div class='brief'><p>uint16</p></div><p><p>Unsigned integer, 2 bytes</p></p><hr/><h1><a name='//apple_ref/cpp/Variable/buffer.VALUE_TYPE_UINT32' class='dashAnchor'></a><a class='entry' name='buffer.VALUE_TYPE_UINT32'>buffer.VALUE_TYPE_UINT32</a></h1><div class='brief'><p>uint32</p></div><p><p>Unsigned integer, 4 bytes</p></p><hr/><h1><a name='//apple_ref/cpp/Variable/buffer.VALUE_TYPE_UINT64' class='dashAnchor'></a><a class='entry' name='buffer.VALUE_TYPE_UINT64'>buffer.VALUE_TYPE_UINT64</a></h1><div class='brief'><p>uint64</p></div><p><p>Unsigned integer, 8 bytes</p></p><hr/><h1><a name='//apple_ref/cpp/Variable/buffer.VALUE_TYPE_UINT8' class='dashAnchor'></a><a class='entry' name='buffer.VALUE_TYPE_UINT8'>buffer.VALUE_TYPE_UINT8</a></h1><div class='brief'><p>uint8</p></div><p><p>Unsigned integer, 1 byte</p></p><hr/><h1><a name='//apple_ref/cpp/Function/buffer.copy_buffer' class='dashAnchor'></a><a class='entry' name='buffer.copy_buffer'>buffer.copy_buffer()</a></h1><div class='brief'><p>copies one buffer to another</p></div><p><p>Copy all data streams from one buffer to another, element wise.</p>
<p><span class="icon-attention"></span> Each of the source streams must have a matching stream in the
destination buffer. The streams must match in both type and size.
The source and destination buffer can be the same.</p></p><h3>PARAMETERS</h3><div class='params'><p class='param'>dst<p><span class="type">buffer</span> the destination buffer</p></p><p class='param'>dstoffset<p><span class="type">number</span> the offset to start copying data to</p></p><p class='param'>src<p><span class="type">buffer</span> the source data buffer</p></p><p class='param'>srcoffset<p><span class="type">number</span> the offset to start copying data from</p></p><p class='param'>count<p><span class="type">number</span> the number of elements to copy</p></p></div><h3>EXAMPLES</h3><div class='examples'><p><p>How to copy elements (e.g. vertices) from one buffer to another</p>
<div class="codehilite"><pre><span></span><span class="c1">-- copy entire buffer</span>
<span class="n">buffer</span><span class="p">.</span><span class="n">copy_buffer</span><span class="p">(</span><span class="n">dstbuffer</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">srcbuffer</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">#</span><span class="n">srcbuffer</span><span class="p">)</span>

<span class="c1">-- copy last 10 elements to the front of another buffer</span>
<span class="n">buffer</span><span class="p">.</span><span class="n">copy_buffer</span><span class="p">(</span><span class="n">dstbuffer</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">srcbuffer</span><span class="p">,</span> <span class="o">#</span><span class="n">srcbuffer</span> <span class="o">-</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
</pre></div></p></div><hr/><h1><a name='//apple_ref/cpp/Function/buffer.copy_stream' class='dashAnchor'></a><a class='entry' name='buffer.copy_stream'>buffer.copy_stream()</a></h1><div class='brief'><p>copies data from one stream to another</p></div><p><p>Copy a specified amount of data from one stream to another.</p>
<p><span class="icon-attention"></span> The value type must match between source and destination streams.
The source and destination streams can be the same.</p></p><h3>PARAMETERS</h3><div class='params'><p class='param'>dst<p><span class="type">bufferstream</span> the destination stream</p></p><p class='param'>dstoffset<p><span class="type">number</span> the offset to start copying data to</p></p><p class='param'>src<p><span class="type">bufferstream</span> the source data stream</p></p><p class='param'>srcoffset<p><span class="type">number</span> the offset to start copying data from</p></p><p class='param'>count<p><span class="type">number</span> the number of values to copy</p></p></div><h3>EXAMPLES</h3><div class='examples'><p><p>How to update a texture of a sprite:</p>
<div class="codehilite"><pre><span></span><span class="c1">-- copy entire stream</span>
<span class="kd">local</span> <span class="n">srcstream</span> <span class="o">=</span> <span class="n">buffer</span><span class="p">.</span><span class="n">get_stream</span><span class="p">(</span><span class="n">srcbuffer</span><span class="p">,</span> <span class="n">hash</span><span class="p">(</span><span class="s2">&quot;</span><span class="s">luminance&quot;</span><span class="p">))</span>
<span class="kd">local</span> <span class="n">dststream</span> <span class="o">=</span> <span class="n">buffer</span><span class="p">.</span><span class="n">get_stream</span><span class="p">(</span><span class="n">dstbuffer</span><span class="p">,</span> <span class="n">hash</span><span class="p">(</span><span class="s2">&quot;</span><span class="s">a&quot;</span><span class="p">))</span>
<span class="n">buffer</span><span class="p">.</span><span class="n">copy_stream</span><span class="p">(</span><span class="n">dststream</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">srcstream</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">#</span><span class="n">srcstream</span><span class="p">)</span>
</pre></div></p></div><hr/><h1><a name='//apple_ref/cpp/Function/buffer.create' class='dashAnchor'></a><a class='entry' name='buffer.create'>buffer.create()</a></h1><div class='brief'><p>creates a new buffer</p></div><p><p>Create a new data buffer containing a specified set of streams. A data buffer
can contain one or more streams with typed data. This is useful for managing
compound data, for instance a vertex buffer could contain separate streams for
vertex position, color, normal etc.</p></p><h3>PARAMETERS</h3><div class='params'><p class='param'>element_count<p><span class="type">number</span> The number of elements the buffer should hold</p></p><p class='param'>declaration<p><span class="type">table</span> A table where each entry (table) describes a stream</p>
<ul>
<li><span class="type">hash | string</span> <code>name</code>: The name of the stream</li>
<li><span class="type">constant</span> <code>type</code>: The data type of the stream</li>
<li><span class="type">number</span> <code>count</code>: The number of values each element should hold</li>
</ul></p></div><h3>EXAMPLES</h3><div class='examples'><p><p>How to create and initialize a buffer</p>
<div class="codehilite"><pre><span></span><span class="k">function</span> <span class="nf">init</span><span class="p">(</span><span class="n">self</span><span class="p">)</span>
  <span class="kd">local</span> <span class="n">size</span> <span class="o">=</span> <span class="mi">128</span>
  <span class="n">self</span><span class="p">.</span><span class="n">image</span> <span class="o">=</span> <span class="n">buffer</span><span class="p">.</span><span class="n">create</span><span class="p">(</span> <span class="n">size</span> <span class="o">*</span> <span class="n">size</span><span class="p">,</span> <span class="p">{</span> <span class="p">{</span><span class="n">name</span><span class="o">=</span><span class="n">hash</span><span class="p">(</span><span class="s2">&quot;</span><span class="s">rgb&quot;</span><span class="p">),</span> <span class="nb">type</span><span class="o">=</span><span class="n">buffer</span><span class="p">.</span><span class="n">VALUE_TYPE_UINT8</span><span class="p">,</span> <span class="n">count</span><span class="o">=</span><span class="mi">3</span> <span class="p">}</span> <span class="p">})</span>
  <span class="n">self</span><span class="p">.</span><span class="n">imagestream</span> <span class="o">=</span> <span class="n">buffer</span><span class="p">.</span><span class="n">get_stream</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">image</span><span class="p">,</span> <span class="n">hash</span><span class="p">(</span><span class="s2">&quot;</span><span class="s">rgb&quot;</span><span class="p">))</span>

  <span class="k">for</span> <span class="n">y</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">self</span><span class="p">.</span><span class="n">height</span><span class="o">-</span><span class="mi">1</span> <span class="k">do</span>
     <span class="k">for</span> <span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">self</span><span class="p">.</span><span class="n">width</span><span class="o">-</span><span class="mi">1</span> <span class="k">do</span>
         <span class="kd">local</span> <span class="n">index</span> <span class="o">=</span> <span class="n">y</span> <span class="o">*</span> <span class="n">self</span><span class="p">.</span><span class="n">width</span> <span class="o">*</span> <span class="mi">3</span> <span class="o">+</span> <span class="n">x</span> <span class="o">*</span> <span class="mi">3</span> <span class="o">+</span> <span class="mi">1</span>
         <span class="n">self</span><span class="p">.</span><span class="n">imagestream</span><span class="p">[</span><span class="n">index</span> <span class="o">+</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="n">r</span>
         <span class="n">self</span><span class="p">.</span><span class="n">imagestream</span><span class="p">[</span><span class="n">index</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="n">g</span>
         <span class="n">self</span><span class="p">.</span><span class="n">imagestream</span><span class="p">[</span><span class="n">index</span> <span class="o">+</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="n">b</span>
     <span class="k">end</span>
  <span class="k">end</span>
</pre></div></p></div><hr/><h1><a name='//apple_ref/cpp/Function/buffer.get_bytes' class='dashAnchor'></a><a class='entry' name='buffer.get_bytes'>buffer.get_bytes()</a></h1><div class='brief'><p>gets data from a stream</p></div><p><p>Get all the bytes from a specified stream as a Lua string.</p></p><h3>PARAMETERS</h3><div class='params'><p class='param'>buffer<p><span class="type">buffer</span> the source buffer</p></p><p class='param'>stream_name<p><span class="type">hash</span> the name of the stream</p></p></div><h3>RETURN</h3><div class='return'><p>data - <p><span class="type">string</span> the buffer data as a Lua string</p></p></div><hr/><h1><a name='//apple_ref/cpp/Function/buffer.get_stream' class='dashAnchor'></a><a class='entry' name='buffer.get_stream'>buffer.get_stream()</a></h1><div class='brief'><p>gets a stream from a buffer</p></div><p><p>Get a specified stream from a buffer.</p></p><h3>PARAMETERS</h3><div class='params'><p class='param'>buffer<p><span class="type">buffer</span> the buffer to get the stream from</p></p><p class='param'>stream_name<p><span class="type">hash | string</span> the stream name</p></p></div><h3>RETURN</h3><div class='return'><p>stream - <p><span class="type">bufferstream</span> the data stream</p></p></div><hr/></body></html>