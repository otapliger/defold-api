<html><head><link rel='stylesheet' type='text/css' href='../defold.css'></head><body><div class='nav'><a class='chevron' href='../index.html'><img src='../svg/chevron-left.svg' alt='Home'></a></div><h1>Sound</h1>
<p><p>Functions and messages for controlling sound components and
mixer groups.</p></p>
<h1><a name='//apple_ref/cpp/Command/play_sound' class='dashAnchor'></a><a class='entry' name='play_sound'>play_sound</a></h1><div class='brief'><p>plays a sound</p></div><p><p>Post this message to a sound-component to make it play its sound. Multiple voices is support. The limit is set to 32 voices per sound component.</p>
<p><span class="icon-attention"></span> Note that gain is in linear scale, between 0 and 1.
To get the dB value from the gain, use the formula <code>20 * log(gain)</code>.
Inversely, to find the linear value from a dB value, use the formula
<code>10<sup>db/20</sup></code>.</p></p><h3>PARAMETERS</h3><div class='params'><p class='param'>[delay]<p><span class="type">number</span> delay in seconds before the sound starts playing, default is 0.</p></p><p class='param'>[gain]<p><span class="type">number</span> sound gain between 0 and 1, default is 1.</p></p></div><h3>EXAMPLES</h3><div class='examples'><p><p>Assuming the script belongs to an instance with a sound-component with id "sound", this will make the component play its sound after 1 second:</p>
<div class="codehilite"><pre><span></span><span class="n">msg</span><span class="p">.</span><span class="n">post</span><span class="p">(</span><span class="s2">&quot;</span><span class="s">#sound&quot;</span><span class="p">,</span> <span class="s2">&quot;</span><span class="s">play_sound&quot;</span><span class="p">,</span> <span class="p">{</span><span class="n">delay</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">gain</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">})</span>
</pre></div></p></div><hr/><h1><a name='//apple_ref/cpp/Command/set_gain' class='dashAnchor'></a><a class='entry' name='set_gain'>set_gain</a></h1><div class='brief'><p>set sound gain</p></div><p><p>Post this message to a sound-component to set gain on all active playing voices.</p>
<p><span class="icon-attention"></span> Note that gain is in linear scale, between 0 and 1.
To get the dB value from the gain, use the formula <code>20 * log(gain)</code>.
Inversely, to find the linear value from a dB value, use the formula
<code>10<sup>db/20</sup></code>.</p></p><h3>PARAMETERS</h3><div class='params'><p class='param'>[gain]<p><span class="type">number</span> sound gain between 0 and 1, default is 1.</p></p></div><h3>EXAMPLES</h3><div class='examples'><p><p>Assuming the script belongs to an instance with a sound-component with id "sound", this will set the gain to 0.5</p>
<div class="codehilite"><pre><span></span><span class="n">msg</span><span class="p">.</span><span class="n">post</span><span class="p">(</span><span class="s2">&quot;</span><span class="s">#sound&quot;</span><span class="p">,</span> <span class="s2">&quot;</span><span class="s">set_gain&quot;</span><span class="p">,</span> <span class="p">{</span><span class="n">gain</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">})</span>
</pre></div></p></div><hr/><h1><a name='//apple_ref/cpp/Function/sound.get_group_gain' class='dashAnchor'></a><a class='entry' name='sound.get_group_gain'>sound.get_group_gain()</a></h1><div class='brief'><p>get mixer group gain</p></div><p><p>Get mixer group gain</p>
<p><span class="icon-attention"></span> Note that gain is in linear scale, between 0 and 1.
To get the dB value from the gain, use the formula <code>20 * log(gain)</code>.
Inversely, to find the linear value from a dB value, use the formula
<code>10<sup>db/20</sup></code>.</p></p><h3>PARAMETERS</h3><div class='params'><p class='param'>group<p><span class="type">string | hash</span> group name</p></p></div><h3>RETURN</h3><div class='return'><p>gain - <p><span class="type">number</span> gain in linear scale</p></p></div><h3>EXAMPLES</h3><div class='examples'><p><p>Get the mixer group gain for the "soundfx" and convert to dB:</p>
<div class="codehilite"><pre><span></span><span class="kd">local</span> <span class="n">gain</span> <span class="o">=</span> <span class="n">sound</span><span class="p">.</span><span class="n">get_group_gain</span><span class="p">(</span><span class="s2">&quot;</span><span class="s">soundfx&quot;</span><span class="p">)</span>
<span class="kd">local</span> <span class="n">gain_db</span> <span class="o">=</span> <span class="mi">20</span> <span class="o">*</span> <span class="n">log</span><span class="p">(</span><span class="n">gain</span><span class="p">)</span>
</pre></div></p></div><hr/><h1><a name='//apple_ref/cpp/Function/sound.get_group_name' class='dashAnchor'></a><a class='entry' name='sound.get_group_name'>sound.get_group_name()</a></h1><div class='brief'><p>get mixer group name string</p></div><p><p>Get a mixer group name as a string.</p>
<p><span class="icon-attention"></span> This function is to be used for debugging and
development tooling only. The function does a reverse hash lookup, which does not
return a proper string value when the game is built in release mode.</p></p><h3>PARAMETERS</h3><div class='params'><p class='param'>group<p><span class="type">string | hash</span> group name</p></p></div><h3>RETURN</h3><div class='return'><p>name - <p><span class="type">string</span> group name</p></p></div><h3>EXAMPLES</h3><div class='examples'><p><p>Get the mixer group string names so we can show them as labels on a dev mixer overlay:</p>
<div class="codehilite"><pre><span></span><span class="kd">local</span> <span class="n">groups</span> <span class="o">=</span> <span class="n">sound</span><span class="p">.</span><span class="n">get_groups</span><span class="p">()</span>
<span class="k">for</span> <span class="n">_</span><span class="p">,</span><span class="n">group</span> <span class="k">in</span> <span class="nb">ipairs</span><span class="p">(</span><span class="n">groups</span><span class="p">)</span> <span class="k">do</span>
    <span class="kd">local</span> <span class="n">name</span> <span class="o">=</span> <span class="n">sound</span><span class="p">.</span><span class="n">get_group_name</span><span class="p">(</span><span class="n">group</span><span class="p">)</span>
    <span class="n">msg</span><span class="p">.</span><span class="n">post</span><span class="p">(</span><span class="s2">&quot;</span><span class="s">/mixer_overlay#gui&quot;</span><span class="p">,</span> <span class="s2">&quot;</span><span class="s">set_mixer_label&quot;</span><span class="p">,</span> <span class="p">{</span> <span class="n">group</span> <span class="o">=</span> <span class="n">group</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="n">name</span><span class="p">})</span>
<span class="k">end</span>
</pre></div></p></div><hr/><h1><a name='//apple_ref/cpp/Function/sound.get_groups' class='dashAnchor'></a><a class='entry' name='sound.get_groups'>sound.get_groups()</a></h1><div class='brief'><p>get all mixer group names</p></div><p><p>Get a table of all mixer group names (hashes).</p></p><h3>RETURN</h3><div class='return'><p>groups - <p><span class="type">table</span> table of mixer group names</p></p></div><h3>EXAMPLES</h3><div class='examples'><p><p>Get the mixer groups, set all gains to 0 except for "master" and "soundfx"
where gain is set to 1:</p>
<div class="codehilite"><pre><span></span><span class="kd">local</span> <span class="n">groups</span> <span class="o">=</span> <span class="n">sound</span><span class="p">.</span><span class="n">get_groups</span><span class="p">()</span>
<span class="k">for</span> <span class="n">_</span><span class="p">,</span><span class="n">group</span> <span class="k">in</span> <span class="nb">ipairs</span><span class="p">(</span><span class="n">groups</span><span class="p">)</span> <span class="k">do</span>
    <span class="k">if</span> <span class="n">group</span> <span class="o">==</span> <span class="n">hash</span><span class="p">(</span><span class="s2">&quot;</span><span class="s">master&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="n">group</span> <span class="o">==</span> <span class="n">hash</span><span class="p">(</span><span class="s2">&quot;</span><span class="s">soundfx&quot;</span><span class="p">)</span> <span class="k">then</span>
        <span class="n">sound</span><span class="p">.</span><span class="n">set_group_gain</span><span class="p">(</span><span class="n">group</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="k">else</span>
        <span class="n">sound</span><span class="p">.</span><span class="n">set_group_gain</span><span class="p">(</span><span class="n">group</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="k">end</span>
<span class="k">end</span>
</pre></div></p></div><hr/><h1><a name='//apple_ref/cpp/Function/sound.get_peak' class='dashAnchor'></a><a class='entry' name='sound.get_peak'>sound.get_peak()</a></h1><div class='brief'><p>get peak gain value from mixer group</p></div><p><p>Get peak value from mixer group.</p>
<p><span class="icon-attention"></span> Note that gain is in linear scale, between 0 and 1.
To get the dB value from the gain, use the formula <code>20 * log(gain)</code>.
Inversely, to find the linear value from a dB value, use the formula
<code>10<sup>db/20</sup></code>.
Also note that the returned value might be an approximation and in particular
the effective window might be larger than specified.</p></p><h3>PARAMETERS</h3><div class='params'><p class='param'>group<p><span class="type">string | hash</span> group name</p></p><p class='param'>window<p><span class="type">number</span> window length in seconds</p></p></div><h3>RETURN</h3><div class='return'><p>peak_l - <p><span class="type">number</span> peak value for left channel</p></p><p>peak_r - <p><span class="type">number</span> peak value for right channel</p></p></div><h3>EXAMPLES</h3><div class='examples'><p><p>Get the peak gain from the "master" group and convert to dB for displaying:</p>
<div class="codehilite"><pre><span></span><span class="kd">local</span> <span class="n">left_p</span><span class="p">,</span> <span class="n">right_p</span> <span class="o">=</span> <span class="n">sound</span><span class="p">.</span><span class="n">get_peak</span><span class="p">(</span><span class="s2">&quot;</span><span class="s">master&quot;</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span>
<span class="n">left_p_db</span> <span class="o">=</span> <span class="mi">20</span> <span class="o">*</span> <span class="n">log</span><span class="p">(</span><span class="n">left_p</span><span class="p">)</span>
<span class="n">right_p_db</span> <span class="o">=</span> <span class="mi">20</span> <span class="o">*</span> <span class="n">log</span><span class="p">(</span><span class="n">right_p</span><span class="p">)</span>
</pre></div></p></div><hr/><h1><a name='//apple_ref/cpp/Function/sound.get_rms' class='dashAnchor'></a><a class='entry' name='sound.get_rms'>sound.get_rms()</a></h1><div class='brief'><p>get RMS value from mixer group</p></div><p><p>Get RMS (Root Mean Square) value from mixer group. This value is the
square root of the mean (average) value of the squared function of
the instantaneous values.</p>
<p>For instance: for a sinewave signal with a peak gain of -1.94 dB (0.8 linear),
the RMS is <code>0.8 &times; 1/sqrt(2)</code> which is about 0.566.</p>
<p><span class="icon-attention"></span> Note the returned value might be an approximation and in particular
the effective window might be larger than specified.</p></p><h3>PARAMETERS</h3><div class='params'><p class='param'>group<p><span class="type">string | hash</span> group name</p></p><p class='param'>window<p><span class="type">number</span> window length in seconds</p></p></div><h3>RETURN</h3><div class='return'><p>rms_l - <p><span class="type">number</span> RMS value for left channel</p></p><p>rms_r - <p><span class="type">number</span> RMS value for right channel</p></p></div><h3>EXAMPLES</h3><div class='examples'><p><p>Get the RMS from the "master" group where a mono -1.94 dB sinewave is playing:</p>
<div class="codehilite"><pre><span></span><span class="kd">local</span> <span class="n">rms</span> <span class="o">=</span> <span class="n">sound</span><span class="p">.</span><span class="n">get_rms</span><span class="p">(</span><span class="s2">&quot;</span><span class="s">master&quot;</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span> <span class="c1">-- throw away right channel.</span>
<span class="nb">print</span><span class="p">(</span><span class="n">rms</span><span class="p">)</span> <span class="c1">--&gt; 0.56555819511414</span>
</pre></div></p></div><hr/><h1><a name='//apple_ref/cpp/Function/sound.is_music_playing' class='dashAnchor'></a><a class='entry' name='sound.is_music_playing'>sound.is_music_playing()</a></h1><div class='brief'><p>check if background music is playing</p></div><p><p>Checks if background music is playing, e.g. from iTunes.</p>
<p><span class="icon-macos"></span><span class="icon-windows"></span><span class="icon-linux"></span><span class="icon-html5"></span> On non mobile platforms,
this function always return <code>false</code>.</p></p><h3>RETURN</h3><div class='return'><p>playing - <p><span class="type">boolean</span> <code>true</code> if music is playing, otherwise <code>false</code>.</p></p></div><h3>EXAMPLES</h3><div class='examples'><p><p>If music is playing, mute "master":</p>
<div class="codehilite"><pre><span></span><span class="k">if</span> <span class="n">sound</span><span class="p">.</span><span class="n">is_music_playing</span><span class="p">()</span> <span class="k">then</span>
    <span class="c1">-- mute &quot;master&quot;</span>
    <span class="n">sound</span><span class="p">.</span><span class="n">set_group_gain</span><span class="p">(</span><span class="s2">&quot;</span><span class="s">master&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="k">end</span>
</pre></div></p></div><hr/><h1><a name='//apple_ref/cpp/Function/sound.is_phone_call_active' class='dashAnchor'></a><a class='entry' name='sound.is_phone_call_active'>sound.is_phone_call_active()</a></h1><div class='brief'><p>check if a phone call is active</p></div><p><p>Checks if a phone call is active. If there is an active phone call all
other sounds will be muted until the phone call is finished.</p>
<p><span class="icon-macos"></span><span class="icon-windows"></span><span class="icon-linux"></span><span class="icon-html5"></span> On non mobile platforms,
this function always return <code>false</code>.</p></p><h3>RETURN</h3><div class='return'><p>call_active - <p><span class="type">boolean</span> <code>true</code> if there is an active phone call, <code>false</code> otherwise.</p></p></div><h3>EXAMPLES</h3><div class='examples'><p><p>Test if a phone call is on-going:</p>
<div class="codehilite"><pre><span></span><span class="k">if</span> <span class="n">sound</span><span class="p">.</span><span class="n">is_phone_call_active</span><span class="p">()</span> <span class="k">then</span>
    <span class="c1">-- do something sensible.</span>
<span class="k">end</span>
</pre></div></p></div><hr/><h1><a name='//apple_ref/cpp/Function/sound.play' class='dashAnchor'></a><a class='entry' name='sound.play'>sound.play()</a></h1><div class='brief'><p>plays a sound</p></div><p><p>Make the sound component play its sound. Multiple voices is supported. The limit is set to 32 voices per sound component.</p>
<p><span class="icon-attention"></span> Note that gain is in linear scale, between 0 and 1.
To get the dB value from the gain, use the formula <code>20 * log(gain)</code>.
Inversely, to find the linear value from a dB value, use the formula
<code>10<sup>db/20</sup></code>.</p></p><h3>PARAMETERS</h3><div class='params'><p class='param'>url<p><span class="type">string | hash | url</span> the sound that should play</p></p><p class='param'>[play_properties]<dl>
<dt><span class="type">table</span> optional table with properties:</dt>
<dt><code>delay</code></dt>
<dd><span class="type">number</span> delay in seconds before the sound starts playing, default is 0.</dd>
<dt><code>gain</code></dt>
<dd><span class="type">number</span> sound gain between 0 and 1, default is 1. The final gain of the sound will be a combination of this gain, the group gain and the master gain.</dd>
</dl></p></div><h3>EXAMPLES</h3><div class='examples'><p><p>Assuming the script belongs to an instance with a sound-component with id "sound", this will make the component play its sound after 1 second:</p>
<div class="codehilite"><pre><span></span><span class="n">sound</span><span class="p">.</span><span class="n">play</span><span class="p">(</span><span class="s2">&quot;</span><span class="s">#sound&quot;</span><span class="p">,</span> <span class="p">{</span> <span class="n">delay</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">gain</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="p">}</span> <span class="p">)</span>
</pre></div></p></div><hr/><h1><a name='//apple_ref/cpp/Function/sound.set_gain' class='dashAnchor'></a><a class='entry' name='sound.set_gain'>sound.set_gain()</a></h1><div class='brief'><p>set sound gain</p></div><p><p>Set gain on all active playing voices of a sound.</p>
<p><span class="icon-attention"></span> Note that gain is in linear scale, between 0 and 1.
To get the dB value from the gain, use the formula <code>20 * log(gain)</code>.
Inversely, to find the linear value from a dB value, use the formula
<code>10<sup>db/20</sup></code>.</p></p><h3>PARAMETERS</h3><div class='params'><p class='param'>url<p><span class="type">string | hash | url</span> the sound to set the gain of</p></p><p class='param'>[gain]<p><span class="type">number</span> sound gain between 0 and 1. The final gain of the sound will be a combination of this gain, the group gain and the master gain.</p></p></div><h3>EXAMPLES</h3><div class='examples'><p><p>Assuming the script belongs to an instance with a sound-component with id "sound", this will set the gain to 0.5</p>
<div class="codehilite"><pre><span></span><span class="n">sound</span><span class="p">.</span><span class="n">set_gain</span><span class="p">(</span><span class="s2">&quot;</span><span class="s">#sound&quot;</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>
</pre></div></p></div><hr/><h1><a name='//apple_ref/cpp/Function/sound.set_group_gain' class='dashAnchor'></a><a class='entry' name='sound.set_group_gain'>sound.set_group_gain()</a></h1><div class='brief'><p>set mixer group gain</p></div><p><p>Set mixer group gain</p>
<p><span class="icon-attention"></span> Note that gain is in linear scale, between 0 and 1.
To get the dB value from the gain, use the formula <code>20 * log(gain)</code>.
Inversely, to find the linear value from a dB value, use the formula
<code>10<sup>db/20</sup></code>.</p></p><h3>PARAMETERS</h3><div class='params'><p class='param'>group<p><span class="type">string | hash</span> group name</p></p><p class='param'>gain<p><span class="type">number</span> gain in linear scale</p></p></div><h3>EXAMPLES</h3><div class='examples'><p><p>Set mixer group gain on the "soundfx" group to -4 dB:</p>
<div class="codehilite"><pre><span></span><span class="kd">local</span> <span class="n">gain_db</span> <span class="o">=</span> <span class="o">-</span><span class="mi">4</span>
<span class="kd">local</span> <span class="n">gain</span> <span class="o">=</span> <span class="mi">10</span><span class="o">^</span><span class="n">gain_db</span><span class="o">/</span><span class="mi">20</span> <span class="c1">-- 0.63095734448019</span>
<span class="n">sound</span><span class="p">.</span><span class="n">set_group_gain</span><span class="p">(</span><span class="s2">&quot;</span><span class="s">soundfx&quot;</span><span class="p">,</span> <span class="n">gain</span><span class="p">)</span>
</pre></div></p></div><hr/><h1><a name='//apple_ref/cpp/Function/sound.stop' class='dashAnchor'></a><a class='entry' name='sound.stop'>sound.stop()</a></h1><div class='brief'><p>stop a playing a sound(s)</p></div><p><p>Stop playing all active voices</p></p><h3>PARAMETERS</h3><div class='params'><p class='param'>url<p><span class="type">string | hash | url</span> the sound that should stop</p></p></div><h3>EXAMPLES</h3><div class='examples'><p><p>Assuming the script belongs to an instance with a sound-component with id "sound", this will make the component stop all playing voices:</p>
<div class="codehilite"><pre><span></span><span class="n">sound</span><span class="p">.</span><span class="n">stop</span><span class="p">(</span><span class="s2">&quot;</span><span class="s">#sound&quot;</span><span class="p">)</span>
</pre></div></p></div><hr/><h1><a name='//apple_ref/cpp/Command/stop_sound' class='dashAnchor'></a><a class='entry' name='stop_sound'>stop_sound</a></h1><div class='brief'><p>stop a playing a sound(s)</p></div><p><p>Post this message to a sound-component to make it stop playing all active voices</p></p><h3>EXAMPLES</h3><div class='examples'><p><p>Assuming the script belongs to an instance with a sound-component with id "sound", this will make the component stop all playing voices:</p>
<div class="codehilite"><pre><span></span><span class="n">msg</span><span class="p">.</span><span class="n">post</span><span class="p">(</span><span class="s2">&quot;</span><span class="s">#sound&quot;</span><span class="p">,</span> <span class="s2">&quot;</span><span class="s">stop_sound&quot;</span><span class="p">)</span>
</pre></div></p></div><hr/></body></html>