<html><head><link rel='stylesheet' type='text/css' href='../defold.css'></head><body><div class='nav'><a class='chevron' href='../index.html'><img src='../svg/chevron-left.svg' alt='Home'></a></div><h1>BitOp</h1>
<p><p><a href="http://bitop.luajit.org/api.html">Lua BitOp</a> is a C extension module for Lua 5.1/5.2 which adds bitwise operations on numbers.</p>
<p>Lua BitOp is Copyright &copy; 2008-2012 Mike Pall.
Lua BitOp is free software, released under the MIT license (same license as the Lua core).</p>
<p>Lua BitOp is compatible with the built-in bitwise operations in LuaJIT 2.0 and is used
on platforms where Defold runs without LuaJIT.</p>
<p>For clarity the examples assume the definition of a helper function <code>printx()</code>.
This prints its argument as an unsigned 32 bit hexadecimal number on all platforms:</p>
<div class="codehilite"><pre><span></span><span class="k">function</span> <span class="nf">printx</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
  <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="s">0x&quot;</span><span class="o">..</span><span class="n">bit</span><span class="p">.</span><span class="n">tohex</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="k">end</span>
</pre></div></p>
<h1><a name='//apple_ref/cpp/Function/bit.arshift' class='dashAnchor'></a><a class='entry' name='bit.arshift'>bit.arshift()</a></h1><div class='brief'><p>bitwise arithmetic right-shift</p></div><p><p>Returns the bitwise arithmetic right-shift of its first argument by the number of bits given by the second argument.
Arithmetic right-shift treats the most-significant bit as a sign bit and replicates it.
Only the lower 5 bits of the shift count are used (reduces to the range [0..31]).</p></p><h3>PARAMETERS</h3><div class='params'><p class='param'>x<p><span class="type">number</span> number</p></p><p class='param'>n<p><span class="type">number</span> number of bits</p></p></div><h3>RETURN</h3><div class='return'><p>y - <p><span class="type">number</span> bitwise arithmetic right-shifted number</p></p></div><h3>EXAMPLES</h3><div class='examples'><p><div class="codehilite"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">bit</span><span class="p">.</span><span class="n">arshift</span><span class="p">(</span><span class="mi">256</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>           <span class="c1">--&gt; 1</span>
<span class="nb">print</span><span class="p">(</span><span class="n">bit</span><span class="p">.</span><span class="n">arshift</span><span class="p">(</span><span class="o">-</span><span class="mi">256</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>          <span class="c1">--&gt; -1</span>
<span class="n">printx</span><span class="p">(</span><span class="n">bit</span><span class="p">.</span><span class="n">arshift</span><span class="p">(</span><span class="mh">0x87654321</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>  <span class="c1">--&gt; 0xfff87654</span>
</pre></div></p></div><hr/><h1><a name='//apple_ref/cpp/Function/bit.band' class='dashAnchor'></a><a class='entry' name='bit.band'>bit.band()</a></h1><div class='brief'><p>bitwise and</p></div><p><p>Returns the bitwise and of all of its arguments. Note that more than two arguments are allowed.</p></p><h3>PARAMETERS</h3><div class='params'><p class='param'>x1<p><span class="type">number</span> number</p></p><p class='param'>[x2...]<p><span class="type">number</span> number(s)</p></p></div><h3>RETURN</h3><div class='return'><p>y - <p><span class="type">number</span> bitwise and of the provided arguments</p></p></div><h3>EXAMPLES</h3><div class='examples'><p><div class="codehilite"><pre><span></span><span class="n">printx</span><span class="p">(</span><span class="n">bit</span><span class="p">.</span><span class="n">band</span><span class="p">(</span><span class="mh">0x12345678</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">))</span>        <span class="c1">--&gt; 0x00000078</span>
</pre></div></p></div><hr/><h1><a name='//apple_ref/cpp/Function/bit.bnot' class='dashAnchor'></a><a class='entry' name='bit.bnot'>bit.bnot()</a></h1><div class='brief'><p>bitwise not</p></div><p><p>Returns the bitwise not of its argument.</p></p><h3>PARAMETERS</h3><div class='params'><p class='param'>x<p><span class="type">number</span> number</p></p></div><h3>RETURN</h3><div class='return'><p>y - <p><span class="type">number</span> bitwise not of number x</p></p></div><h3>EXAMPLES</h3><div class='examples'><p><div class="codehilite"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">bit</span><span class="p">.</span><span class="n">bnot</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>            <span class="c1">--&gt; -1</span>
<span class="n">printx</span><span class="p">(</span><span class="n">bit</span><span class="p">.</span><span class="n">bnot</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>           <span class="c1">--&gt; 0xffffffff</span>
<span class="nb">print</span><span class="p">(</span><span class="n">bit</span><span class="p">.</span><span class="n">bnot</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>           <span class="c1">--&gt; 0</span>
<span class="nb">print</span><span class="p">(</span><span class="n">bit</span><span class="p">.</span><span class="n">bnot</span><span class="p">(</span><span class="mh">0xffffffff</span><span class="p">))</span>   <span class="c1">--&gt; 0</span>
<span class="n">printx</span><span class="p">(</span><span class="n">bit</span><span class="p">.</span><span class="n">bnot</span><span class="p">(</span><span class="mh">0x12345678</span><span class="p">))</span>  <span class="c1">--&gt; 0xedcba987</span>
</pre></div></p></div><hr/><h1><a name='//apple_ref/cpp/Function/bit.bor' class='dashAnchor'></a><a class='entry' name='bit.bor'>bit.bor()</a></h1><div class='brief'><p>bitwise or</p></div><p><p>Returns the bitwise or of all of its arguments. Note that more than two arguments are allowed.</p></p><h3>PARAMETERS</h3><div class='params'><p class='param'>x1<p><span class="type">number</span> number</p></p><p class='param'>[x2...]<p><span class="type">number</span> number(s)</p></p></div><h3>RETURN</h3><div class='return'><p>y - <p><span class="type">number</span> bitwise or of the provided arguments</p></p></div><h3>EXAMPLES</h3><div class='examples'><p><div class="codehilite"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">bit</span><span class="p">.</span><span class="n">bor</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>                <span class="c1">--&gt; 15</span>
</pre></div></p></div><hr/><h1><a name='//apple_ref/cpp/Function/bit.bswap' class='dashAnchor'></a><a class='entry' name='bit.bswap'>bit.bswap()</a></h1><div class='brief'><p>bitwise swap</p></div><p><p>Swaps the bytes of its argument and returns it. This can be used to convert little-endian 32 bit numbers to big-endian 32 bit numbers or vice versa.</p></p><h3>PARAMETERS</h3><div class='params'><p class='param'>x<p><span class="type">number</span> number</p></p></div><h3>RETURN</h3><div class='return'><p>y - <p><span class="type">number</span> bitwise swapped number</p></p></div><h3>EXAMPLES</h3><div class='examples'><p><div class="codehilite"><pre><span></span><span class="n">printx</span><span class="p">(</span><span class="n">bit</span><span class="p">.</span><span class="n">bswap</span><span class="p">(</span><span class="mh">0x12345678</span><span class="p">))</span> <span class="c1">--&gt; 0x78563412</span>
<span class="n">printx</span><span class="p">(</span><span class="n">bit</span><span class="p">.</span><span class="n">bswap</span><span class="p">(</span><span class="mh">0x78563412</span><span class="p">))</span> <span class="c1">--&gt; 0x12345678</span>
</pre></div></p></div><hr/><h1><a name='//apple_ref/cpp/Function/bit.bxor' class='dashAnchor'></a><a class='entry' name='bit.bxor'>bit.bxor()</a></h1><div class='brief'><p>bitwise xor</p></div><p><p>Returns the bitwise xor of all of its arguments. Note that more than two arguments are allowed.</p></p><h3>PARAMETERS</h3><div class='params'><p class='param'>x1<p><span class="type">number</span> number</p></p><p class='param'>[x2...]<p><span class="type">number</span> number(s)</p></p></div><h3>RETURN</h3><div class='return'><p>y - <p><span class="type">number</span> bitwise xor of the provided arguments</p></p></div><h3>EXAMPLES</h3><div class='examples'><p><div class="codehilite"><pre><span></span><span class="n">printx</span><span class="p">(</span><span class="n">bit</span><span class="p">.</span><span class="n">bxor</span><span class="p">(</span><span class="mh">0xa5a5f0f0</span><span class="p">,</span> <span class="mh">0xaa55ff00</span><span class="p">))</span>  <span class="c1">--&gt; 0x0ff00ff0</span>
</pre></div></p></div><hr/><h1><a name='//apple_ref/cpp/Function/bit.lshift' class='dashAnchor'></a><a class='entry' name='bit.lshift'>bit.lshift()</a></h1><div class='brief'><p>bitwise logical left-shift</p></div><p><p>Returns the bitwise logical left-shift of its first argument by the number of bits given by the second argument.
Logical shifts treat the first argument as an unsigned number and shift in 0-bits.
Only the lower 5 bits of the shift count are used (reduces to the range [0..31]).</p></p><h3>PARAMETERS</h3><div class='params'><p class='param'>x<p><span class="type">number</span> number</p></p><p class='param'>n<p><span class="type">number</span> number of bits</p></p></div><h3>RETURN</h3><div class='return'><p>y - <p><span class="type">number</span> bitwise logical left-shifted number</p></p></div><h3>EXAMPLES</h3><div class='examples'><p><div class="codehilite"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">bit</span><span class="p">.</span><span class="n">lshift</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>              <span class="c1">--&gt; 1</span>
<span class="nb">print</span><span class="p">(</span><span class="n">bit</span><span class="p">.</span><span class="n">lshift</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>              <span class="c1">--&gt; 256</span>
<span class="nb">print</span><span class="p">(</span><span class="n">bit</span><span class="p">.</span><span class="n">lshift</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">40</span><span class="p">))</span>             <span class="c1">--&gt; 256</span>
<span class="n">printx</span><span class="p">(</span><span class="n">bit</span><span class="p">.</span><span class="n">lshift</span><span class="p">(</span><span class="mh">0x87654321</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>   <span class="c1">--&gt; 0x54321000</span>
</pre></div></p></div><hr/><h1><a name='//apple_ref/cpp/Function/bit.rol' class='dashAnchor'></a><a class='entry' name='bit.rol'>bit.rol()</a></h1><div class='brief'><p>bitwise left rotation</p></div><p><p>Returns the bitwise left rotation of its first argument by the number of bits given by the second argument. Bits shifted out on one side are shifted back in on the other side.
Only the lower 5 bits of the rotate count are used (reduces to the range [0..31]).</p></p><h3>PARAMETERS</h3><div class='params'><p class='param'>x<p><span class="type">number</span> number</p></p><p class='param'>n<p><span class="type">number</span> number of bits</p></p></div><h3>RETURN</h3><div class='return'><p>y - <p><span class="type">number</span> bitwise left-rotated number</p></p></div><h3>EXAMPLES</h3><div class='examples'><p><div class="codehilite"><pre><span></span><span class="n">printx</span><span class="p">(</span><span class="n">bit</span><span class="p">.</span><span class="n">rol</span><span class="p">(</span><span class="mh">0x12345678</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>   <span class="c1">--&gt; 0x45678123</span>
</pre></div></p></div><hr/><h1><a name='//apple_ref/cpp/Function/bit.ror' class='dashAnchor'></a><a class='entry' name='bit.ror'>bit.ror()</a></h1><div class='brief'><p>bitwise right rotation</p></div><p><p>Returns the bitwise right rotation of its first argument by the number of bits given by the second argument. Bits shifted out on one side are shifted back in on the other side.
Only the lower 5 bits of the rotate count are used (reduces to the range [0..31]).</p></p><h3>PARAMETERS</h3><div class='params'><p class='param'>x<p><span class="type">number</span> number</p></p><p class='param'>n<p><span class="type">number</span> number of bits</p></p></div><h3>RETURN</h3><div class='return'><p>y - <p><span class="type">number</span> bitwise right-rotated number</p></p></div><h3>EXAMPLES</h3><div class='examples'><p><div class="codehilite"><pre><span></span><span class="n">printx</span><span class="p">(</span><span class="n">bit</span><span class="p">.</span><span class="n">ror</span><span class="p">(</span><span class="mh">0x12345678</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>   <span class="c1">--&gt; 0x67812345</span>
</pre></div></p></div><hr/><h1><a name='//apple_ref/cpp/Function/bit.rshift' class='dashAnchor'></a><a class='entry' name='bit.rshift'>bit.rshift()</a></h1><div class='brief'><p>bitwise logical right-shift</p></div><p><p>Returns the bitwise logical right-shift of its first argument by the number of bits given by the second argument.
Logical shifts treat the first argument as an unsigned number and shift in 0-bits.
Only the lower 5 bits of the shift count are used (reduces to the range [0..31]).</p></p><h3>PARAMETERS</h3><div class='params'><p class='param'>x<p><span class="type">number</span> number</p></p><p class='param'>n<p><span class="type">number</span> number of bits</p></p></div><h3>RETURN</h3><div class='return'><p>y - <p><span class="type">number</span> bitwise logical right-shifted number</p></p></div><h3>EXAMPLES</h3><div class='examples'><p><div class="codehilite"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">bit</span><span class="p">.</span><span class="n">rshift</span><span class="p">(</span><span class="mi">256</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>            <span class="c1">--&gt; 1</span>
<span class="nb">print</span><span class="p">(</span><span class="n">bit</span><span class="p">.</span><span class="n">rshift</span><span class="p">(</span><span class="o">-</span><span class="mi">256</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>           <span class="c1">--&gt; 16777215</span>
<span class="n">printx</span><span class="p">(</span><span class="n">bit</span><span class="p">.</span><span class="n">rshift</span><span class="p">(</span><span class="mh">0x87654321</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>   <span class="c1">--&gt; 0x00087654</span>
</pre></div></p></div><hr/><h1><a name='//apple_ref/cpp/Function/bit.tobit' class='dashAnchor'></a><a class='entry' name='bit.tobit'>bit.tobit()</a></h1><div class='brief'><p>normalize number to the numeric range for bit operations</p></div><p><p>Normalizes a number to the numeric range for bit operations and returns it. This function is usually not needed since all bit operations already normalize all of their input arguments.</p></p><h3>PARAMETERS</h3><div class='params'><p class='param'>x<p><span class="type">number</span> number to normalize</p></p></div><h3>RETURN</h3><div class='return'><p>y - <p><span class="type">number</span> normalized number</p></p></div><h3>EXAMPLES</h3><div class='examples'><p><div class="codehilite"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="mh">0xffffffff</span><span class="p">)</span>                <span class="c1">--&gt; 4294967295 (*)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">bit</span><span class="p">.</span><span class="n">tobit</span><span class="p">(</span><span class="mh">0xffffffff</span><span class="p">))</span>     <span class="c1">--&gt; -1</span>
<span class="n">printx</span><span class="p">(</span><span class="n">bit</span><span class="p">.</span><span class="n">tobit</span><span class="p">(</span><span class="mh">0xffffffff</span><span class="p">))</span>    <span class="c1">--&gt; 0xffffffff</span>
<span class="nb">print</span><span class="p">(</span><span class="n">bit</span><span class="p">.</span><span class="n">tobit</span><span class="p">(</span><span class="mh">0xffffffff</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span> <span class="c1">--&gt; 0</span>
<span class="nb">print</span><span class="p">(</span><span class="n">bit</span><span class="p">.</span><span class="n">tobit</span><span class="p">(</span><span class="mi">2</span><span class="o">^</span><span class="mi">40</span> <span class="o">+</span> <span class="mi">1234</span><span class="p">))</span>    <span class="c1">--&gt; 1234</span>
</pre></div>


<p>(*) See the treatment of hex literals for an explanation why the printed numbers in the first two lines differ (if your Lua installation uses a double number type).</p></p></div><hr/><h1><a name='//apple_ref/cpp/Function/bit.tohex' class='dashAnchor'></a><a class='entry' name='bit.tohex'>bit.tohex()</a></h1><div class='brief'><p>convert number to a hex string</p></div><p><p>Converts its first argument to a hex string. The number of hex digits is given by the absolute value of the optional second argument. Positive numbers between 1 and 8 generate lowercase hex digits. Negative numbers generate uppercase hex digits. Only the least-significant 4*|n| bits are used. The default is to generate 8 lowercase hex digits.</p></p><h3>PARAMETERS</h3><div class='params'><p class='param'>x<p><span class="type">number</span> number to convert</p></p><p class='param'>n<p><span class="type">number</span> number of hex digits to return</p></p></div><h3>RETURN</h3><div class='return'><p>s - <p><span class="type">string</span> hexadecimal string</p></p></div><h3>EXAMPLES</h3><div class='examples'><p><div class="codehilite"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">bit</span><span class="p">.</span><span class="n">tohex</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>              <span class="c1">--&gt; 00000001</span>
<span class="nb">print</span><span class="p">(</span><span class="n">bit</span><span class="p">.</span><span class="n">tohex</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>             <span class="c1">--&gt; ffffffff</span>
<span class="nb">print</span><span class="p">(</span><span class="n">bit</span><span class="p">.</span><span class="n">tohex</span><span class="p">(</span><span class="mh">0xffffffff</span><span class="p">))</span>     <span class="c1">--&gt; ffffffff</span>
<span class="nb">print</span><span class="p">(</span><span class="n">bit</span><span class="p">.</span><span class="n">tohex</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">8</span><span class="p">))</span>         <span class="c1">--&gt; FFFFFFFF</span>
<span class="nb">print</span><span class="p">(</span><span class="n">bit</span><span class="p">.</span><span class="n">tohex</span><span class="p">(</span><span class="mh">0x21</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>        <span class="c1">--&gt; 0021</span>
<span class="nb">print</span><span class="p">(</span><span class="n">bit</span><span class="p">.</span><span class="n">tohex</span><span class="p">(</span><span class="mh">0x87654321</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>  <span class="c1">--&gt; 4321</span>
</pre></div></p></div><hr/></body></html>